import yt
from yt.units import dimensions
import matplotlib
matplotlib.use('ps')
#from yt.mods import *
import numpy as np
import pylab as pl
#from string import rstrip
#import fields_bfield
#import tracer_def

MRH = 0.76
h2conv = (2.0/1.3158)
heconv = (4.0/1.3158)
pc_to_cm = 3.08567758e18

#my_type = '0yr'
my_type = '1000yr'

rad =  [3.15899449e+13, 3.51612347e+13, 3.91362639e+13, 4.35606761e+13,
 4.84852746e+13, 5.39666062e+13, 6.00676104e+13, 6.68583421e+13,
 7.44167759e+13, 8.28297019e+13, 9.21937215e+13, 1.02616357e+14,
 1.14217287e+14, 1.27129720e+14, 1.41501921e+14, 1.57498922e+14,
 1.75304406e+14, 1.95122827e+14, 2.17181750e+14, 2.41734466e+14,
 2.69062903e+14, 2.99480859e+14, 3.33337611e+14, 3.71021918e+14,
 4.12966491e+14, 4.59652960e+14, 5.11617403e+14, 5.69456503e+14,
 6.33834398e+14, 7.05490308e+14, 7.85247025e+14, 8.74020356e+14,
 9.72829642e+14, 1.08280946e+15, 1.20522267e+15, 1.34147486e+15,
 1.49313057e+15, 1.66193117e+15, 1.84981493e+15, 2.05893923e+15,
 2.29170534e+15, 2.55078600e+15, 2.83915611e+15, 3.16012688e+15,
 3.51738387e+15, 3.91502929e+15, 4.35762910e+15, 4.85026548e+15,
 5.39859513e+15, 6.00891424e+15, 6.68823083e+15, 7.44434516e+15,
 8.28593933e+15, 9.22267695e+15, 1.02653141e+16, 1.14258230e+16,
 1.27175291e+16, 1.41552645e+16, 1.57555379e+16, 1.75367246e+16,
 1.95192771e+16, 2.17259601e+16, 2.41821119e+16, 2.69159352e+16,
 2.99588212e+16, 3.33457100e+16, 3.71154916e+16, 4.13114524e+16,
 4.59817729e+16, 5.11800799e+16, 5.69660632e+16, 6.34061604e+16,
 7.05743201e+16, 7.85528507e+16, 8.74333660e+16, 9.73178366e+16,
 1.08319761e+17, 1.20565469e+17, 1.34195573e+17, 1.49366580e+17,
 1.66252691e+17, 1.85047802e+17, 2.05967729e+17, 2.29252683e+17,
 2.55170036e+17, 2.84017384e+17, 3.16125967e+17, 3.51864472e+17,
 3.91643268e+17, 4.35919115e+17, 4.85200412e+17, 5.40053032e+17,
 6.01106822e+17, 6.69062832e+17, 7.44701369e+17, 8.28890953e+17,
 9.22598294e+17, 1.02689939e+18, 1.14299187e+18, 1.27220879e+18]

vrad =  [ 8.94825682,  5.35137517,  7.04009545,  0.,          0.,         29.86486623,
 14.41703333, 17.20155232,  4.50658408, 21.96734244, 19.855736,    9.1861652,
 25.4361153 , 18.10520682, 19.41722743, 12.91679836, 13.15709217,  8.8507779,
  7.22177943,  5.11932748,  3.93693413,  3.51198734,  2.3152466 ,  2.00996276,
  1.24117391,  1.15376023,  0.73402147,  0.67640639,  0.36121464,  0.25146208,
  0.45893457,  0.45628117,  0.53766179,  1.0721967 ,  1.01850382,  0.65774273,
  0.15854221, -0.22441377, -0.59396643, -0.39352524,  0.06547241,  0.22839387,
  0.17200179,  0.24024432,  0.33861761,  0.49047952,  0.78825196,  0.65762664,
  0.48073167,  0.63376054,  1.27239531,  2.15927958,  2.56102043,  3.07650153,
  3.40140937,  3.58854707,  3.56119374,  3.47778371,  3.38804144,  3.29501428,
  3.16579783,  3.01895249,  2.87278189,  2.73412652, 2.61586404 , 2.50738439,
  2.41255784,  2.33338853,  2.26870546,  2.2081147 , 2.14022028 , 2.07455877,
  2.00528212,  1.93859671,  1.87994589,  1.84239494,  1.81790174,  1.78743637,
  1.75570849,  1.7263792 ,  1.70463051,  1.6841433 ,  1.65790835,  1.63277174,
  1.60996997,  1.60852664,  1.6209984 ,  1.62723089,  1.60392966,  1.53543446,
  1.42568747,  1.28365635,  1.13333734,  0.95770259,  0.72335265,  0.6685048,
  0.75795143,  0.8655177 ,  1.17005149,  1.41256269]

mdot =  [ 2.94032955e+19,  3.55787614e+19,  4.56812681e+19,  0.00000000e+00,
  0.00000000e+00,  3.70134886e+20,  3.07719668e+20,  3.18368792e+20,
  1.09005362e+20,  6.88031559e+20,  9.40635183e+20,  5.79401669e+20,
  2.01173432e+21,  2.07539919e+21,  2.55130616e+21,  4.84048963e+21,
  1.02846902e+22,  5.97256831e+23,  1.10174074e+24,  1.20884471e+24,
  1.44416575e+24,  1.77860734e+24,  1.59526635e+24,  1.84839667e+24,
  1.40438565e+24,  1.58554329e+24,  1.17984842e+24,  1.25933360e+24,
  8.53116368e+23,  7.85486454e+23,  1.55475500e+24,  1.50479468e+24,
  1.74821401e+24,  3.97879277e+24,  4.79782648e+24,  4.01641709e+24,
  1.17397093e+24, -1.82320968e+24, -6.75703541e+24, -3.26072746e+24,
  3.47177751e+23,  1.16711451e+24,  8.48880271e+23,  1.09100041e+24,
  1.20841485e+24,  1.39921788e+24,  1.96106844e+24,  1.90958280e+24,
  1.23996689e+24,  1.24118308e+24,  1.95201017e+24,  2.55993794e+24,
  2.91279547e+24,  3.34942473e+24,  3.56768345e+24,  3.74097246e+24,
  3.70979418e+24,  3.59071173e+24,  3.40513024e+24,  3.19401732e+24,
  2.92968395e+24,  2.65059674e+24,  2.40070905e+24,  2.17529079e+24,
  1.97201141e+24,  1.80212559e+24,  1.65647163e+24,  1.53185021e+24,
  1.42908199e+24,  1.34611707e+24,  1.27289879e+24,  1.20895019e+24,
  1.15588212e+24,  1.11505322e+24,  1.08649523e+24,  1.07682039e+24,
  1.08433790e+24,  1.09181846e+24,  1.08850173e+24,  1.07188889e+24,
  1.04255052e+24,  1.00731983e+24,  9.72590248e+23,  9.40642009e+23,
  9.11653650e+23,  8.96365459e+23,  8.90616648e+23,  8.79816391e+23,
  8.58815791e+23,  8.15946116e+23,  7.46241676e+23,  6.54334289e+23,
  5.55511237e+23,  4.53776443e+23,  3.42033808e+23,  2.64186403e+23,
  2.41196233e+23,  2.50292646e+23,  3.30657803e+23,  3.68607907e+23]

rad0 =  [1.02043733e+13, 1.14876954e+13, 1.29324107e+13, 1.45588162e+13,
 1.63897616e+13, 1.84509704e+13, 2.07714008e+13, 2.33836532e+13,
 2.63244275e+13, 2.96350395e+13, 3.33620005e+13, 3.75576715e+13,
 4.22809984e+13, 4.75983402e+13, 5.35844013e+13, 6.03232814e+13,
 6.79096562e+13, 7.64501086e+13, 8.60646251e+13, 9.68882822e+13,
 1.09073144e+14, 1.22790397e+14, 1.38232760e+14, 1.55617185e+14,
 1.75187909e+14, 1.97219886e+14, 2.22022648e+14, 2.49944654e+14,
 2.81378187e+14, 3.16764863e+14, 3.56601837e+14, 4.01448788e+14,
 4.51935780e+14, 5.08772115e+14, 5.72756300e+14, 6.44787262e+14,
 7.25876980e+14, 8.17164702e+14, 9.19932947e+14, 1.03562553e+15,
 1.16586784e+15, 1.31248968e+15, 1.47755097e+15, 1.66337070e+15,
 1.87255948e+15, 2.10805625e+15, 2.37316956e+15, 2.67162405e+15,
 3.00761276e+15, 3.38585608e+15, 3.81166802e+15, 4.29103091e+15,
 4.83067942e+15, 5.43819520e+15, 6.12211336e+15, 6.89204241e+15,
 7.75879926e+15, 8.73456117e+15, 9.83303681e+15, 1.10696589e+16,
 1.24618011e+16, 1.40290218e+16, 1.57933392e+16, 1.77795407e+16,
 2.00155308e+16, 2.25327235e+16, 2.53664832e+16, 2.85566222e+16,
 3.21479594e+16, 3.61909502e+16, 4.07423955e+16, 4.58662395e+16,
 5.16344683e+16, 5.81281209e+16, 6.54384281e+16, 7.36680939e+16,
 8.29327388e+16, 9.33625236e+16, 1.05103979e+17, 1.18322063e+17,
 1.33202479e+17, 1.49954285e+17, 1.68812832e+17, 1.90043067e+17,
 2.13943258e+17, 2.40849184e+17, 2.71138852e+17, 3.05237809e+17,
 3.43625119e+17, 3.86840092e+17, 4.35489865e+17, 4.90257929e+17,
 5.51913734e+17, 6.21323494e+17, 6.99462362e+17, 7.87428129e+17,
 8.86456644e+17, 9.97939181e+17, 1.12344198e+18, 1.26472826e+18]

vrad0 =  [ 3.33088321e+01,  0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
  0.00000000e+00,  0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
  0.00000000e+00,  0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
  2.49643915e+01,  0.00000000e+00,  2.43563841e+01,  2.17632848e+01,
  2.43167958e+01,  2.39948337e+01,  2.26067240e+01,  2.15426665e+01,
  2.47502586e+01,  2.63932790e+01,  2.09436170e+01,  2.26967134e+01,
  3.80504658e+01,  5.44760907e+00,  4.38154114e+00,  3.86275347e+00,
  2.09119719e+00,  1.81076324e+00,  1.37350178e+00,  1.18461437e+00,
  1.24395589e+00,  8.81355066e-01,  3.21946756e-01, -1.20072656e-02,
 -9.76280246e-02,  6.07327499e-01,  1.07365056e+00,  1.68865665e+00,
  2.09614203e+00,  1.60365740e+00,  5.03786372e-01, -9.40963877e-02,
  1.61737136e-03,  2.46133076e+00,  2.61176287e+00,  1.07651619e+00,
  1.37867882e+00,  1.44860577e+00,  1.84870513e+00,  2.17395567e+00,
  2.56813649e+00,  3.29315394e+00,  3.77250572e+00,  4.61918565e+00,
  4.58255310e+00,  4.37017774e+00,  4.12484344e+00,  3.93319499e+00,
  3.79698238e+00,  3.65755493e+00,  3.48139806e+00,  3.28186490e+00,
  3.09199494e+00,  2.92463773e+00,  2.77752310e+00,  2.65171735e+00,
  2.54843706e+00,  2.45939214e+00,  2.37948737e+00,  2.30390055e+00,
  2.22336945e+00,  2.14076869e+00,  2.05921360e+00,  1.98480426e+00,
  1.92245808e+00,  1.87129613e+00,  1.83425354e+00,  1.80159927e+00,
  1.76643135e+00,  1.72822510e+00,  1.69638510e+00,  1.66843435e+00,
  1.64088924e+00,  1.61537240e+00,  1.60386149e+00,  1.60987091e+00,
  1.62090614e+00,  1.60596951e+00,  1.53404003e+00,  1.41137060e+00,
  1.25357571e+00,  1.08498198e+00,  8.69551911e-01,  6.67681067e-01,
  7.32517137e-01,  8.40750685e-01,  1.09636536e+00,  1.41464826e+00]

mdot0 =  [ 4.35854546e+12,  0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
  0.00000000e+00,  0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
  0.00000000e+00,  0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
  5.60816715e+13,  0.00000000e+00,  8.78818271e+13,  9.95185081e+13,
  1.40922036e+14,  1.76231466e+14,  2.10424591e+14,  2.54127385e+14,
  3.70019745e+14,  5.00070984e+14,  5.02901745e+14,  6.90697015e+14,
  5.31157165e+22,  1.89977439e+23,  2.62994424e+23,  3.94101012e+23,
  3.69477842e+23,  5.01256360e+23,  6.31218026e+23,  8.01363239e+23,
  1.17033024e+24,  9.82397325e+23,  4.42530763e+23, -1.98143690e+22,
 -2.02015618e+23,  1.68689738e+24,  4.13880688e+24,  7.31637242e+24,
  9.43721947e+24,  9.12696884e+24,  6.02541366e+24, -1.21340556e+24,
  2.27751090e+22,  1.23614961e+26,  2.19160052e+26,  7.56445724e+25,
  4.41053209e+25,  2.07333139e+25,  1.64582750e+25,  1.61033781e+25,
  1.56040821e+25,  8.63582742e+24,  1.07784875e+25,  8.63158797e+24,
  6.14580914e+24,  5.72384502e+24,  5.12526991e+24,  4.57473148e+24,
  4.13311089e+24,  3.73449499e+24,  3.35013057e+24,  2.99580484e+24,
  2.68985201e+24,  2.42719781e+24,  2.19849638e+24,  2.00440252e+24,
  1.83840906e+24,  1.69743385e+24,  1.57347530e+24,  1.46776030e+24,
  1.37476799e+24,  1.29260957e+24,  1.22253344e+24,  1.16678272e+24,
  1.12745576e+24,  1.10469871e+24,  1.09809830e+24,  1.09946037e+24,
  1.09370788e+24,  1.07179221e+24,  1.03811985e+24,  1.00057547e+24,
  9.61935795e+23,  9.24928764e+23,  9.00085569e+23,  8.90207133e+23,
  8.82647909e+23,  8.64301779e+23,  8.17468370e+23,  7.41398037e+23,
  6.36251577e+23,  5.26375274e+23,  4.10714573e+23,  2.98521724e+23,
  2.49455966e+23,  2.46512231e+23,  3.12935218e+23,  3.69060668e+23]



mdot = np.asarray(mdot)
mdot0 = np.asarray(mdot0)

mdot = mdot  / 2.e33 * 3.15e7
mdot0 = mdot0  / 2.e33 * 3.15e7

rad = np.asarray(rad)
rad0 = np.asarray(rad0)

rad = rad  / 1.5e13
rad0 = rad0  / 1.5e13

print('mdot = ', mdot)
print('mdot0 = ',mdot0)
print('rad = ', rad)
print('rad0 = ', rad0)

rmin = 1.e1
rmax = 1.e5
#rmax = 1.e6

fsize = 12


mmin = 1.e-3
mmax = 1.e0
pl.clf()
pl.gca()
pl.plot(rad0, mdot0,'k', linewidth=2.0, label='hydro')
pl.plot(rad, mdot,'b:', linewidth=2.0, label='MHD')
ax = pl.gca()
ax.set_xscale('log')
ax.set_yscale('log')
ax.set_xlabel('radius [AU]', fontsize=fsize)
ax.set_ylabel('dM/dt [M$_{\odot}$ yr$^{-1}$]', fontsize=fsize)
pl.xticks(fontsize=fsize)
pl.yticks(fontsize=fsize)
pl.legend(loc='upper right', fontsize=10)
pl.axis((rmin, rmax, mmin, mmax))
if my_type == '0yr':
	pl.title('t = 0 years')
	pl.savefig('radprof_mdot_t240.eps')
else:
	pl.title('t = 1000 years')
	pl.savefig('radprof_mdot_t400.eps')



vmin=-5
vmax=10
pl.clf()
pl.gca()
pl.plot(rad0, vrad0,'k', linewidth=2.0, label = 'hydro')
pl.plot(rad, vrad,'b:', linewidth=2.0, label='MHD')
ax = pl.gca()
ax.set_xscale('log')
#ax.set_yscale('log')
ax.set_xlabel('radius [AU]', fontsize=fsize)
ax.set_ylabel(r'v$_{rad}$', fontsize=fsize)
pl.xticks(fontsize=fsize)
pl.yticks(fontsize=fsize)
pl.legend(loc=1, fontsize=fsize)
pl.axis((rmin, rmax, vmin, vmax))
if my_type == '0yr':
	pl.savefig('radprof_vrad_t240.eps')
else:
	pl.savefig('radprof_vrad_t400.eps')
